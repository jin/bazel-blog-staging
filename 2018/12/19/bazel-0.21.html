<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/WebPage">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bazel 0.21 - Bazel</title>

    <link rel="canonical" href="/2018/12/19/bazel-0.21.html">
    <link rel="alternate" type="application/rss+xml" title="Bazel Blog" href="/feed.xml">

    <!-- Webfont -->
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro:400,500,700|Open+Sans:400,600,700,800" rel="stylesheet">

    <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

    <!-- Bootstrap -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/font-awesome.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom stylesheet -->
    <link rel="stylesheet" type="text/css" href="/css/main.css">

    <!-- metadata -->
    <meta name="og:title" content="Bazel 0.21">
    <meta name="og:image" content="https://bazel.build/images/bazel-og-image.png">
  </head>

  <body>
        <nav id="common-nav" class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://bazel.build/">
            <img class="navbar-logo" src="/images/bazel-navbar.svg">
          </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="https://github.com/bazelbuild/bazel">
                <span class="hidden-sm">GitHub</span>
                <span class="nav-icon visible-sm"><i class="fa fa-github"></i></span>
              </a>
            </li>
          </ul>
          <form class="navbar-form navbar-right" action="https://bazel.build/search.html" id="cse-search-box">
            <div class="form-group">
              <input type="hidden" name="cx" value="012346921571893344015:xv_nfgpzbu4">
              <input type="hidden" name="cof" value="FORID:10">
              <input type="hidden" name="ie" value="UTF-8">
              <input type="search" name="q" class="form-control input-sm" placeholder="Search">
            </div>
          </form>
          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="https://docs.bazel.build">Documentation</a>
            </li>
            <li>
              <a href="https://bazel.build/contributing.html">Contribute</a>
            </li>
            <li>
              <a href="https://blog.bazel.build">
                <span class="hidden-sm">Blog</span>
                <span class="nav-icon visible-sm"><i class="fa fa-rss"></i></span>
              </a>
            </li>
            <li>
              <a href="https://twitter.com/bazelbuild">
                <span class="visible-xs">Twitter</span>
                <span><i class="nav-icon fa fa-twitter hidden-xs"></i></span>
              </a>
            </li>
            <li>
              <a href="http://stackoverflow.com/questions/tagged/bazel">
                <span class="visible-xs">StackOverflow</span>
                <span><i class="nav-icon fa fa-stack-overflow hidden-xs"></i></span>
              </a>
            </li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>


    <div class="page-title-bar">
      <div class="container">
        <h1>Bazel Blog</h1>
      </div>
    </div>

    <div class="container vpad">
      <div class="row">
        <div class="col-lg-9">
          <div class="blog-post">
            <h1 class="blog-post-title">Bazel 0.21</h1>
            <div class="blog-post-meta">
              

By



  
  

  
    <a href="https://github.com/laurentlb">Laurent Le Brun</a>
  
  


on <span class="text-muted">19 December 2018</span>

            </div>
            <div class="blog-post-content">
              <p>We&#39;ve just released <a href="https://github.com/bazelbuild/bazel/releases/tag/0.21.0">Bazel 0.21</a>!</p>

<h2>Backward compatibility</h2>

<p>Before updating Bazel, you may try if anything would break with 0.21. To do so, build your code with Bazel 0.20 and the following flags:</p>

<ul>
<li>  <a href="https://github.com/bazelbuild/bazel/issues/6565"><code>--incompatible_disable_sysroot_from_configuration</code></a></li>
<li>  <a href="https://github.com/bazelbuild/bazel/issues/5823"><code>--incompatible_disallow_slash_operator</code></a></li>
<li>  <a href="https://github.com/bazelbuild/bazel/issues/5637"><code>--incompatible_static_name_resolution</code></a></li>
<li>  <a href="https://github.com/bazelbuild/bazel/issues/5827"><code>--incompatible_package_name_is_a_function</code></a></li>
<li>  <a href="https://github.com/bazelbuild/bazel/issues/6656"><code>--incompatible_use_remotejdk_as_host_javabase</code></a></li>
<li>  <a href="https://github.com/bazelbuild/bazel/issues/6537"><code>--incompatible_provide_cc_toolchain_info_from_cc_toolchain_suite</code></a></li>
<li>  <a href="https://github.com/bazelbuild/bazel/issues/6383"><code>--incompatible_disable_depset_in_cc_user_flags</code></a></li>
<li>  <a href="https://github.com/bazelbuild/bazel/issues/6384"><code>--incompatible_disable_late_bound_option_defaults</code></a></li>
<li>  <a href="https://github.com/bazelbuild/bazel/issues/6648"><code>--experimental_strict_action_env</code></a></li>
</ul>

<p>For more information about the changes, please click on the links and read the GitHub issues. Comment there if you need help.</p>

<p>If you use external repositories, you might first have to update the dependencies in your WORKSPACE file.</p>

<p>Changes for which 0.21 is a <a href="https://docs.google.com/document/d/1Dj5PBLmPVg9ZyApm4GobM3y-mDgY3mVaqpRVttOe-ZQ/edit">migration window</a>
are marked with GitHub label <a href="https://github.com/bazelbuild/bazel/issues?q=is%3Aissue+label%3Amigration-0.21">migration-0.21</a>.</p>

<p>Breaking changes in the next release (0.22) are marked with GitHub label
<a href="https://github.com/bazelbuild/bazel/issues?q=is%3Aissue+label%3Abreaking-change-0.22">breaking-change-0.22</a>.</p>

<h2>Android</h2>

<ul>
<li>  We revamped our Android with Bazel tutorial. Check it out
<a href="https://docs.bazel.build/versions/master/tutorial/android-app.html">here</a>.</li>
<li>  <a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--experimental_check_desugar_deps"><code>--experimental_check_desugar_deps</code></a>
is enabled by default. This flag rules out several types of invalid Android
builds at compile-time. Note that this is incompatible with remote Android
builds, so you can disable it with <code>--noexperimental_check_desugar_deps</code>.</li>
<li>  Bazel now supports Android Databinding v2. It can be enabled with
<a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--experimental_android_databinding_v2"><code>--experimental_android_databinding_v2</code></a>.</li>
</ul>

<h2>Apple</h2>

<ul>
<li>  <code>XCRUNWRAPPER_LABEL</code> is removed. If you used this value before, please use @bazel_tools//tools/objc:xcrunwrapper instead.</li>
</ul>

<h2>C++</h2>

<ul>
<li>  The <code>--experimental_stl</code> command line option is removed.</li>
<li>  <a href="https://docs.bazel.build/versions/master/skylark/lib/cpp.html"><code>cpp</code> configuration
fragment</a>
doesn&#39;t do package loading anymore. That means:

<ul>
<li>  You can now use Bazel without a C++ toolchain (as long as you don&#39;t build C++ rules).</li>
<li>  Bazel may start about 2 seconds faster than before, because it does not analyze C++ toolchain anymore when it is not needed.</li>
</ul></li>
</ul>

<h2>Java</h2>

<ul>
<li>  <code>--strict_android_deps</code> and <code>--strict_java_deps</code> are renamed to <code>--experimental_strict_java_deps</code>. (The two flags used to do the same.)</li>
</ul>

<h2>Starlark</h2>

<ul>
<li>  A new incompatible flag <a href="https://github.com/bazelbuild/bazel/issues/6611"><code>--incompatible_strict_argument_ordering</code></a> is added. This concerns a corner case in function calls. When this flag is enabled, <code>*arg</code> and <code>**kwarg</code> have to be after all other arguments.</li>
</ul>

<h2>External repositories</h2>

<ul>
<li>  <a href="https://docs.bazel.build/versions/master/skylark/lib/repository_ctx.html#download"><code>repository_ctx.download</code></a> and <a href="https://docs.bazel.build/versions/master/skylark/lib/repository_ctx.html#download_and_extract"><code>repository_ctx.download_and_extract</code></a> now return a struct, instead of <code>None</code>.</li>
</ul>

<h2>Execution</h2>

<ul>
<li>  <code>--genrule_strategy</code> is deprecated in favor of <a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--strategy"><code>--strategy=Genrule=&lt;strategy&gt;</code></a> (for genrules) or <a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--spawn_strategy"><code>--spawn_strategy=&lt;strategy&gt;</code></a> (for all actions).</li>
<li>  Dynamic execution is now available with <a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--experimental_spawn_scheduler"><code>--experimental_spawn_scheduler</code></a>. Dynamic execution allows a build action to run locally and remotely simultaneously, and Bazel picks the fastest action. This provides the best of both worlds: faster clean builds than pure local builds, and faster incremental builds than pure remote builds.</li>
</ul>

<h2>Other changes</h2>

<ul>
<li>  Our documentation is now versioned. You can see the documentation for a
specific Bazel version. This is especially useful when a flag or a feature
is removed.</li>
<li>  <a href="https://docs.bazel.build/versions/master/user-manual.html#aquery">aquery</a>
defaults to human readable output format, use <code>--output=proto</code> to get the
result in proto format..</li>
<li>  The deprecated and unmaintained Docker rules in <code>tools/build_defs/docker</code>
are removed. Please use
<a href="https://github.com/bazelbuild/rules_docker"><code>https://github.com/bazelbuild/rules_docker</code></a>
instead.</li>
<li>  A new incompatible flag
<a href="https://github.com/bazelbuild/bazel/issues/6761"><code>--incompatible_merge_genfiles_directory</code></a>
is added. When enabled, Bazel does not create a <code>bazel-genfiles</code> directory,
and writes everything to <code>bazel-bin</code> instead.</li>
<li>  When build options change, Bazel discards the analysis cache. The changed
options are now printed in the output. It is possible to control the number
of options to show using
<a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--max_config_changes_to_show"><code>--max_config_changes_to_show</code></a>.</li>
<li>  <a href="https://docs.bazel.build/versions/master/command-line-reference.html#flag--experimental_remote_grpc_log"><code>--experimental_remote_grpc_log</code></a>
now also logs updateActionResult. This is the Remote Execution API call used
in remote caching, so now remote caching
<a href="https://github.com/bazelbuild/tools_remote/">can be debugged</a> using the grpc log.</li>
<li>  The deprecated flavors of <code>http_archive()</code>, <code>http_file()</code>,
<code>git_repository()</code>, etc. no longer respect the <code>HTTP_PROXY</code> and
<code>HTTPS_PROXY</code> environment variables. Support for this was removed to
prevent interference with GRPC,
<a href="https://github.com/bazelbuild/bazel/pull/6340">causing remote builds to fail</a>.
The non-deprecated flavors of these functions should work as intended.</li>
</ul>

<h2>Community</h2>

<ul>
<li>  Natan Silnitsky talked about Wix&#39;s <a href="https://www.youtube.com/watch?v=nKx21CsT744">lessons learned for successful migration to Bazel and Google Cloud Build</a> to build their Scala codebase.</li>
<li>  David Stanke also did a talk: <a href="https://www.youtube.com/watch?v=QFqcKT6sGoc">Build and test your code faster with Bazel, the cloud-accelerated build system</a>.</li>
<li>  Philipp Wollermann created <a href="https://github.com/philwo/bazelisk">Bazelisk</a>, a wrapper for Bazel that automatically picks a good version of Bazel given your current working directory.</li>
<li>  John Millikin started new rules for the <a href="https://github.com/jmillikin/rules_m4">GNU m4</a> macro processor, the <a href="https://github.com/jmillikin/rules_flex">Flex</a> scanner generator, and the <a href="https://github.com/jmillikin/rules_bison">GNU Bison</a> parser generator.</li>
</ul>

<p>This release contains contributions from many people at Google, as well as Andy
Scott, Attila Oláh, Benjamin Peterson, Clint Harrison, Dave Lee, Ed Schouten,
Gregor Jasny, Jamie Snape, Jerry Marino, Loo Rong Jie, Or Shachar, Sevki
Hasirci, and William Chargin.</p>

<p>Thanks to everyone who contributed!</p>

<p>Discuss on <a href="https://news.ycombinator.com/item?id=18716781">HackerNews</a>.</p>

            </div>
            
          </div>
        </div>
                <div class="col-lg-3 hidden-sm hidden-xs">
          <h2>Twitter</h2>
          <p>For more frequent updates, follow us on Twitter.</p>
          <p><a class="twitter-follow-button" href="https://twitter.com/bazelbuild" data-show-count="false" data-size="large">Follow @bazelbuild</a></p>
          <h2>Discuss</h2>
          <p>Join the discussion on our <a href="https://groups.google.com/forum/#!forum/bazel-discuss">mailing list</a>.</p>
          <h2>Subscribe</h2>
          <p>Subscribe to our blog via the <a rel="alternate" type="application/rss+xml" href="/feed.xml">RSS Feed</a> or via email:</p>
          <div class="well">
            <form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=BazelBlog', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
              <div class="form-group">
                <input type="text" class="form-control" name="email" placeholder="name@email.com">
              </div>
              <input type="hidden" value="BazelBlog" name="uri">
              <input type="hidden" name="loc" value="en_US">
              <button type="submit" class="btn btn-primary btn-block">Subscribe</button>
            </form>
            <p>Delivered by <a href="https://feedburner.google.com" target="_blank">FeedBurner</a></p>
          </div>
          <h2>Contribute</h2>
          <p>The source for this blog can be found on <a href="https://github.com/bazelbuild/bazel-blog">GitHub</a>.</p>
          <h2>Archive</h2>
          <p>Looking for a specific post? Find it on the <a href="/archive.html">Archive</a> page.</p>
        </div>

      </div>
    </div>

        <footer class="footer">
      <div class="container">
  <div class="row">
    <div class="col-sm-4 col-md-2">
      <p>About</p>
      <ul class="list-unstyled">
        <li><a href="https://github.com/bazelbuild/bazel/wiki/Bazel-Users">Who's Using Bazel?</a></li>
        <li><a href="https://bazel.build/roadmap.html">Roadmap</a></li>
        <li><a href="https://bazel.build/contributing.html">Contribute</a></li>
        <li><a href="https://bazel.build/governance.html">Governance Plan</a></li>
        <li><a href="https://policies.google.com/privacy">Privacy Policy</a></li>
      </ul>
    </div>
    <div class="col-sm-4 col-md-2">
      <p>Support</p>
      <ul class="list-unstyled">
        <li><a href="http://stackoverflow.com/questions/tagged/bazel">Stack Overflow</a></li>
        <li><a href="https://github.com/bazelbuild/bazel/issues">Issue Tracker</a></li>
        <li><a href="https://docs.bazel.build">Documentation</a></li>
        <li><a href="https://bazel.build/faq.html">FAQ</a></li>
        <li><a href="https://bazel.build/support.html">Support Policy</a></li>
      </ul>
    </div>
    <div class="col-sm-4 col-md-2">
      <p>Stay Connected</p>
      <ul class="list-unstyled">
        <li><a href="https://twitter.com/bazelbuild">Twitter</a></li>
        <li><a href="https://blog.bazel.build">Blog</a></li>
        <li><a href="https://github.com/bazelbuild/bazel">GitHub</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/bazel-discuss">Discussion group</a></li>
      </ul>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      <p class="text-muted">&copy; 2020 Google</p>
    </div>
  </div>
</div>

    </footer>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/assets/js/bootstrap.min.js"></script>

    <script>
      var shiftWindow = function() {
        if (location.hash.length !== 0) {
          window.scrollBy(0, -50);
        }
      };
      window.addEventListener("hashchange", shiftWindow);

      var highlightCurrentSidebarNav = function() {
        var href = location.pathname;
        var item = $('#sidebar-nav [href$="' + href + '"]');
        if (item) {
          var li = item.parent();
          li.addClass("active");

          if (li.parent() && li.parent().is("ul")) {
            do {
              var ul = li.parent();
              if (ul.hasClass("collapse")) {
                ul.collapse("show");
              }
              li = ul.parent();
            } while (li && li.is("li"));
          }
        }
      };

      $(document).ready(function() {
        // Scroll to anchor of location hash, adjusted for fixed navbar.
        window.setTimeout(function() {
          shiftWindow();
        }, 1);

        // Flip the caret when submenu toggles are clicked.
        $(".sidebar-submenu").on("show.bs.collapse", function() {
          var toggle = $('[href$="#' + $(this).attr('id') + '"]');
          if (toggle) {
            toggle.addClass("dropup");
          }
        });
        $(".sidebar-submenu").on("hide.bs.collapse", function() {
          var toggle = $('[href$="#' + $(this).attr('id') + '"]');
          if (toggle) {
            toggle.removeClass("dropup");
          }
        });

        // Highlight the current page on the sidebar nav.
        highlightCurrentSidebarNav();
      });
    </script>

    <!-- Google Analytics tracking code -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-61082125-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!--
JavaScript used by the Follow @bazelbuild on Twitter button on the blog sidebar.
Code from: https://dev.twitter.com/web/follow-button
-->

<script>window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t._e=[];t.ready=function(f){t._e.push(f);};return t;}(document,"script","twitter-wjs"));</script>


    <!-- Anchor JS -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.0/anchor.min.js"></script>
    <script>
      // Automatically add anchors and links to all header elements that don't already have them.
      anchors.add();
    </script>
  </body>
</html>
